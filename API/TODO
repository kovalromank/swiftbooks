Implement functionality and tests

Add detailed comments to functions